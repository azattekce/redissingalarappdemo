<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>joker-ChatApp</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <link href="/site.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.7/signalr.min.js" crossorigin="anonymous"></script>
</head>
<body class="bg-light">
  <!-- Landing (Facebook-like) -->
  <div id="landingShell" class="min-vh-100 d-flex align-items-center" style="background:#f0f2f5;">
    <div class="container py-5">
      <div class="row align-items-center justify-content-center">
        <div class="col-lg-6 mb-4">
          <div class="px-2">
            <div class="display-3 fw-bold" style="color:#1877f2; letter-spacing:-1px;">Joker Chat</div>
            <div class="fs-4 mt-2" style="max-width: 520px;">
              Joker Chat tanıdıklarınla iletişim kurmanı ve hayatında olup bitenleri paylaşmanı sağlar.
            </div>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="card shadow-sm" style="border-radius: 8px;">
            <div class="card-body p-4">
              <div class="mb-3">
                <input id="landingEmail" type="text" class="form-control form-control-lg" placeholder="E-posta veya Telefon Numarası" />
              </div>
              <div class="mb-3">
                <input id="landingPassword" type="password" class="form-control form-control-lg" placeholder="Şifre" />
              </div>
              <button id="btnLandingLogin" class="btn btn-primary btn-lg w-100 fw-semibold" type="button">Giriş Yap</button>
              <div class="text-center mt-3">
                <a id="landingForgot" href="#" class="link-primary small">Şifreni mi Unuttun?</a>
              </div>
              <hr />
              <div class="d-grid">
                <button id="btnLandingRegister" class="btn btn-success btn-lg fw-semibold" type="button">Yeni hesap oluştur</button>
              </div>
            </div>
          </div>
          <div class="text-center mt-3 small">
            Ünlü biri, marka veya işletme için <a href="#" class="fw-semibold">Sayfa oluştur</a>.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- App Shell (hidden until login) -->
  <div id="appShell" style="display:none;">
    <div class="container py-4">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="m-0">Joker-ChatApp</h1>
        <div class="d-flex align-items-center gap-2">
          <div id="welcomeUser" class="text-muted me-2"></div>
          <button id="btnShowRegister" class="btn btn-sm btn-outline-primary">Kayıt Ol</button>
          <button id="btnShowLogin" class="btn btn-sm btn-primary">Giriş Yap</button>
          <button id="btnLogout" class="btn btn-sm btn-outline-danger" style="display:none;">Çıkış</button>
        </div>
      </div>

      <div class="row g-3">
        <div class="col-md-4">
        <!-- Kullanıcı & Arkadaşlar -->
        <div class="card mb-3">
          <div class="card-header">Ben</div>
          <div class="card-body" id="meBox">Giriş yapılmadı</div>
        </div>

        <div class="card mb-3">
          <div class="card-header">Kullanıcılar</div>
          <div class="card-body pt-2 pb-2">
            <input id="usersSearch" class="form-control form-control-sm" placeholder="Ara (isim veya e-posta)" />
          </div>
          <ul id="usersList" class="list-group users-scroll"></ul>
        </div>

        <div class="card mb-3">
          <div class="card-header">Arkadaşlık İstekleri</div>
          <div class="card-body">
            <h6>Gelen</h6>
            <ul id="incomingList" class="list-group mb-2"></ul>
            <h6>Giden</h6>
            <ul id="outgoingList" class="list-group"></ul>
          </div>
        </div>

        <div class="card">
          <div class="card-header">Arkadaşlar</div>
          <ul id="friendsList" class="list-group list-group-flush"></ul>
        </div>
      </div>

      <div class="col-md-8">
        <!-- Sohbet -->
        <div id="chatCard" class="card vh-80 d-flex">
          <div class="card-header" id="chatHeader">Özel Sohbet</div>
          <div class="card-body scroll" id="chatMessages"></div>
          <div class="card-footer">
            <div class="input-group">
              <input id="chatInput" class="form-control" placeholder="Mesaj yazın" />
              <button id="btnSend" class="btn btn-primary" type="button">Gönder</button>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
  </div>

  <footer class="py-3 mt-4 border-top bg-white">
    <div class="container d-flex justify-content-center">
      <small class="text-muted">Geliştirici: <strong>Azat Tekçe</strong></small>
    </div>
  </footer>

  <!-- Toasts (top-center) -->
  <div class="position-fixed top-0 start-50 translate-middle-x w-100" style="z-index: 2000; pointer-events: none; margin-top: 1rem;">
    <div id="toastContainer" class="toast-container d-flex flex-column gap-2 align-items-center" style="max-width: 90vw;"></div>
  </div>

  <!-- Register Modal -->
  <div class="modal fade" id="registerModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Kayıt Ol</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="registerForm" novalidate>
            <div class="mb-3">
              <label class="form-label">E-posta</label>
              <input id="regEmail" type="email" class="form-control" required />
              <div class="invalid-feedback">Lütfen geçerli bir e-posta girin.</div>
            </div>
            <div class="mb-3">
              <label class="form-label">Şifre</label>
              <input id="regPassword" type="password" class="form-control" minlength="6" required />
              <div class="invalid-feedback">Şifre en az 6 karakter olmalıdır.</div>
            </div>
            <div class="mb-3">
              <label class="form-label">Görünen Ad</label>
              <input id="regDisplayName" type="text" class="form-control" minlength="2" required />
              <div class="invalid-feedback">Görünen ad en az 2 karakter olmalıdır.</div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
          <button id="btnRegister" type="button" class="btn btn-primary">Kayıt Ol</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Giriş Yap</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="loginForm" novalidate>
            <div class="mb-3">
              <label class="form-label">E-posta</label>
              <input id="loginEmail" type="email" class="form-control" required />
              <div class="invalid-feedback">Lütfen e-posta girin.</div>
            </div>
            <div class="mb-3">
              <label class="form-label">Şifre</label>
              <input id="loginPassword" type="password" class="form-control" required />
              <div class="invalid-feedback">Lütfen şifrenizi girin.</div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
          <button id="btnLogin" type="button" class="btn btn-primary">Giriş Yap</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Friend Profile Modal -->
  <div class="modal fade" id="friendProfileModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Profil</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="d-flex align-items-center gap-3 mb-3">
            <img id="fpAvatar" class="avatar-lg" alt="avatar" />
            <div>
              <div class="mb-1"><strong>Ad:</strong> <span id="fpName"></span></div>
              <div class="mb-1"><strong>Email:</strong> <span id="fpEmail"></span></div>
              <div class="mb-1"><strong>Telefon:</strong> <span id="fpPhone"></span></div>
            </div>
          </div>
          <div class="mb-2"><strong>Cinsiyet:</strong> <span id="fpGender"></span></div>
          <div class="mb-2"><strong>Adres:</strong> <span id="fpAddress"></span></div>
          <div class="mb-2"><strong>Eğitim:</strong> <span id="fpEducation"></span></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
        </div>
      </div>
    </div>
  </div>

  <!-- My Profile Modal -->
  <div class="modal fade" id="myProfileModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title d-flex align-items-center gap-2">
            <span class="d-inline-block" style="width:20px;height:20px;border-radius:50%;background:#e9ecef;display:inline-flex;align-items:center;justify-content:center;">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-3-3.87"/><path d="M4 21v-2a4 4 0 0 1 3-3.87"/><circle cx="12" cy="7" r="4"/></svg>
            </span>
            Profilim
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="d-flex align-items-center gap-3 mb-3">
            <img id="mpAvatar" class="avatar-lg" alt="avatar" />
            <div class="flex-grow-1">
              <label class="form-label small mb-1">Görünen Ad</label>
              <input id="mpDisplayName" class="form-control form-control-sm" placeholder="Görünen Ad" />
              <div class="mt-2 small text-muted">Email: <span id="mpEmail"></span></div>
            </div>
          </div>
          <label class="form-label small mb-1">Avatar URL</label>
          <input id="mpAvatarUrl" class="form-control form-control-sm mb-2" placeholder="https://... veya data:image/..." />
          <label class="form-label small mb-1">Telefon</label>
          <input id="mpPhone" class="form-control form-control-sm mb-2" placeholder="Telefon" />
          <label class="form-label small mb-1">Cinsiyet</label>
          <select id="mpGender" class="form-select form-select-sm mb-2">
            <option value="">Seçiniz</option>
            <option>Erkek</option>
            <option>Kadın</option>
            <option>Diğer</option>
          </select>
          <label class="form-label small mb-1">Adres</label>
          <input id="mpAddress" class="form-control form-control-sm mb-2" placeholder="Adres" />
          <label class="form-label small mb-1">Eğitim</label>
          <input id="mpEducation" class="form-control form-control-sm mb-2" placeholder="Eğitim" />
          <div class="form-check form-check-sm">
            <input id="mpPhonePublic" class="form-check-input" type="checkbox" />
            <label class="form-check-label" for="mpPhonePublic">Telefon herkese açık</label>
          </div>
          <div class="form-check form-check-sm">
            <input id="mpAddressPublic" class="form-check-input" type="checkbox" />
            <label class="form-check-label" for="mpAddressPublic">Adres herkese açık</label>
          </div>
        </div>
        <div class="modal-footer">
          <button id="btnMyProfileSave" type="button" class="btn btn-primary">Kaydet</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
        </div>
      </div>
    </div>
  </div>

      <!-- Video Call Modal -->
      <div class="modal fade" id="videoCallModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Görüntülü Görüşme</h5>
              <div class="d-flex align-items-center gap-2">
                <button id="btnModalWide" class="btn btn-sm btn-outline-secondary" type="button" title="Genişlet (XL)"><i class="bi bi-arrows-angle-expand"></i></button>
                <button id="btnModalFull" class="btn btn-sm btn-outline-secondary" type="button" title="Tam Ekran"><i class="bi bi-fullscreen"></i></button>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
            </div>
            <div class="modal-body">
              <div class="video-wrapper">
                <div class="video-stage">
                  <video id="remoteVideo" class="video-large" autoplay playsinline></video>
                  <video id="localVideo" class="video-small" autoplay playsinline muted></video>
                  <div class="video-controls">
                    <button id="btnZoomOut" class="ctrl-btn" title="Uzaklaştır"><i class="bi bi-zoom-out"></i></button>
                    <button id="btnZoomIn" class="ctrl-btn" title="Yakınlaştır"><i class="bi bi-zoom-in"></i></button>
                    <button id="btnZoomReset" class="ctrl-btn" title="Sıfırla"><i class="bi bi-aspect-ratio"></i></button>
                    <button id="btnPipSize" class="ctrl-btn" title="Önizleme Büyüt/Küçült"><i class="bi bi-aspect-ratio-fill"></i></button>
                  </div>
                </div>
              </div>
              <div class="mt-3 d-flex gap-2">
                <button id="btnHangup" type="button" class="btn btn-danger">Görüşmeyi Bitir</button>
              </div>
            </div>
          </div>
        </div>
      </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/app.js"></script>
</body>
</html>
